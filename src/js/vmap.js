/**
 * @version v1.0.1
 */
!function t(i,e,n){function a(r,o){if(!e[r]){if(!i[r]){var h="function"==typeof require&&require;if(!o&&h)return h(r,!0);if(s)return s(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var d=e[r]={exports:{}};i[r][0].call(d.exports,function(t){var e=i[r][1][t];return a(e?e:t)},d,d.exports,t,i,e,n)}return e[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)a(n[r]);return a}({1:[function(t,i,e){!function(t,e,n){"undefined"!=typeof i&&i.exports?i.exports=n():"function"==typeof define&&define.amd?define(n):e[t]=n()}("h337",this,function(){var t={defaultRadius:20,defaultRenderer:"canvas2d",defaultGradient:{.25:"rgb(0,0,255)",.55:"rgb(0,255,0)",.85:"yellow",1:"rgb(255,0,0)"},defaultMaxOpacity:1,defaultMinOpacity:0,defaultBlur:.85,defaultXField:"x",defaultYField:"y",defaultValueField:"value",plugins:{}},i=function(){var i=function(t){this._coordinator={},this._data=[],this._radi=[],this._min=0,this._max=1,this._xField=t.xField||t.defaultXField,this._yField=t.yField||t.defaultYField,this._valueField=t.valueField||t.defaultValueField,t.radius&&(this._cfgRadius=t.radius)},e=t.defaultRadius;return i.prototype={_organiseData:function(t,i){var n=t[this._xField],a=t[this._yField],s=this._radi,r=this._data,o=this._max,h=this._min,l=t[this._valueField]||1,d=t.radius||this._cfgRadius||e;return r[n]||(r[n]=[],s[n]=[]),r[n][a]?r[n][a]+=l:(r[n][a]=l,s[n][a]=d),r[n][a]>o?(i?this.setDataMax(r[n][a]):this._max=r[n][a],!1):{x:n,y:a,value:l,radius:d,min:h,max:o}},_unOrganizeData:function(){var t=[],i=this._data,e=this._radi;for(var n in i)for(var a in i[n])t.push({x:n,y:a,radius:e[n][a],value:i[n][a]});return{min:this._min,max:this._max,data:t}},_onExtremaChange:function(){this._coordinator.emit("extremachange",{min:this._min,max:this._max})},addData:function(){if(arguments[0].length>0)for(var t=arguments[0],i=t.length;i--;)this.addData.call(this,t[i]);else{var e=this._organiseData(arguments[0],!0);e&&this._coordinator.emit("renderpartial",{min:this._min,max:this._max,data:[e]})}return this},setData:function(t){var i=t.data,e=i.length;this._data=[],this._radi=[];for(var n=0;n<e;n++)this._organiseData(i[n],!1);return this._max=t.max,this._min=t.min||0,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},removeData:function(){},setDataMax:function(t){return this._max=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setDataMin:function(t){return this._min=t,this._onExtremaChange(),this._coordinator.emit("renderall",this._getInternalData()),this},setCoordinator:function(t){this._coordinator=t},_getInternalData:function(){return{max:this._max,min:this._min,data:this._data,radi:this._radi}},getData:function(){return this._unOrganizeData()}},i}(),e=function(){function t(t){var e=t.container,n=this.shadowCanvas=document.createElement("canvas"),a=this.canvas=t.canvas||document.createElement("canvas"),s=(this._renderBoundaries=[1e4,1e4,0,0],getComputedStyle(t.container)||{});a.className="heatmap-canvas",this._width=a.width=n.width=+s.width.replace(/px/,""),this._height=a.height=n.height=+s.height.replace(/px/,""),this.shadowCtx=n.getContext("2d"),this.ctx=a.getContext("2d"),a.style.cssText=n.style.cssText="position:absolute;left:0;top:0;",e.style.position="absolute",e.appendChild(a),this._palette=i(t),this._templates={},this._setStyles(t)}var i=function(t){var i=t.gradient||t.defaultGradient,e=document.createElement("canvas"),n=e.getContext("2d");e.width=256,e.height=1;var a=n.createLinearGradient(0,0,256,1);for(var s in i)a.addColorStop(s,i[s]);return n.fillStyle=a,n.fillRect(0,0,256,1),n.getImageData(0,0,256,1).data},e=function(t,i){var e=document.createElement("canvas"),n=e.getContext("2d"),a=t,s=t;if(e.width=e.height=2*t,1==i)n.beginPath(),n.arc(a,s,t,0,2*Math.PI,!1),n.fillStyle="rgba(0,0,0,1)",n.fill();else{var r=n.createRadialGradient(a,s,t*i,a,s,t);r.addColorStop(0,"rgba(0,0,0,1)"),r.addColorStop(1,"rgba(0,0,0,0)"),n.fillStyle=r,n.fillRect(0,0,2*t,2*t)}return e},n=function(t){for(var i=[],e=t.min,n=t.max,a=t.radi,t=t.data,s=Object.keys(t),r=s.length;r--;)for(var o=s[r],h=Object.keys(t[o]),l=h.length;l--;){var d=h[l],u=t[o][d],c=a[o][d];i.push({x:o,y:d,value:u,radius:c})}return{min:e,max:n,data:i}};return t.prototype={renderPartial:function(t){this._drawAlpha(t),this._colorize()},renderAll:function(t){this._clear(),this._drawAlpha(n(t)),this._colorize()},_updateGradient:function(t){this._palette=i(t)},updateConfig:function(t){t.gradient&&this._updateGradient(t),this._setStyles(t)},setDimensions:function(t,i){this._width=t,this._height=i,this.canvas.width=this.shadowCanvas.width=t,this.canvas.height=this.shadowCanvas.height=i},_clear:function(){this.shadowCtx.clearRect(0,0,this._width,this._height),this.ctx.clearRect(0,0,this._width,this._height)},_setStyles:function(t){this._blur=0==t.blur?0:t.blur||t.defaultBlur,t.backgroundColor&&(this.canvas.style.backgroundColor=t.backgroundColor),this._opacity=255*(t.opacity||0),this._maxOpacity=255*(t.maxOpacity||t.defaultMaxOpacity),this._minOpacity=255*(t.minOpacity||t.defaultMinOpacity),this._useGradientOpacity=!!t.useGradientOpacity},_drawAlpha:function(t){for(var i=this._min=t.min,n=this._max=t.max,t=t.data||[],a=t.length,s=1-this._blur;a--;){var r,o=t[a],h=o.x,l=o.y,d=o.radius,u=Math.min(o.value,n),c=h-d,p=l-d,g=this.shadowCtx;this._templates[d]?r=this._templates[d]:this._templates[d]=r=e(d,s),g.globalAlpha=(u-i)/(n-i),g.drawImage(r,c,p),c<this._renderBoundaries[0]&&(this._renderBoundaries[0]=c),p<this._renderBoundaries[1]&&(this._renderBoundaries[1]=p),c+2*d>this._renderBoundaries[2]&&(this._renderBoundaries[2]=c+2*d),p+2*d>this._renderBoundaries[3]&&(this._renderBoundaries[3]=p+2*d)}},_colorize:function(){var t=this._renderBoundaries[0],i=this._renderBoundaries[1],e=this._renderBoundaries[2]-t,n=this._renderBoundaries[3]-i,a=this._width,s=this._height,r=this._opacity,o=this._maxOpacity,h=this._minOpacity,l=this._useGradientOpacity;t<0&&(t=0),i<0&&(i=0),t+e>a&&(e=a-t),i+n>s&&(n=s-i);for(var d=this.shadowCtx.getImageData(t,i,e,n),u=d.data,c=u.length,p=this._palette,g=3;g<c;g+=4){var f=u[g],m=4*f;if(m){var x;x=r>0?r:f<o?f<h?h:f:o,u[g-3]=p[m],u[g-2]=p[m+1],u[g-1]=p[m+2],u[g]=l?p[m+3]:x}}d.data=u,this.ctx.putImageData(d,t,i),this._renderBoundaries=[1e3,1e3,0,0]},getValueAt:function(t){var i,e=this.shadowCtx,n=e.getImageData(t.x,t.y,1,1),a=n.data[3],s=this._max,r=this._min;return i=Math.abs(s-r)*(a/255)>>0},getDataURL:function(){return this.canvas.toDataURL()}},t}(),n=function(){var i=!1;return"canvas2d"===t.defaultRenderer&&(i=e),i}(),a={merge:function(){for(var t={},i=arguments.length,e=0;e<i;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}},s=function(){function e(){var e=this._config=a.merge(t,arguments[0]||{});if(this._coordinator=new s,e.plugin){var o=e.plugin;if(!t.plugins[o])throw new Error("Plugin '"+o+"' not found. Maybe it was not registered.");var h=t.plugins[o];this._renderer=new h.renderer(e),this._store=new h.store(e)}else this._renderer=new n(e),this._store=new i(e);r(this)}var s=function(){function t(){this.cStore={}}return t.prototype={on:function(t,i,e){var n=this.cStore;n[t]||(n[t]=[]),n[t].push(function(t){return i.call(e,t)})},emit:function(t,i){var e=this.cStore;if(e[t])for(var n=e[t].length,a=0;a<n;a++){var s=e[t][a];s(i)}}},t}(),r=function(t){var i=t._renderer,e=t._coordinator,n=t._store;e.on("renderpartial",i.renderPartial,i),e.on("renderall",i.renderAll,i),e.on("extremachange",function(i){t._config.onExtremaChange&&t._config.onExtremaChange({min:i.min,max:i.max,gradient:t._config.gradient||t._config.defaultGradient})}),n.setCoordinator(e)};return e.prototype={addData:function(){return this._store.addData.apply(this._store,arguments),this},removeData:function(){return this._store.removeData&&this._store.removeData.apply(this._store,arguments),this},setData:function(){return this._store.setData.apply(this._store,arguments),this},setDataMax:function(){return this._store.setDataMax.apply(this._store,arguments),this},setDataMin:function(){return this._store.setDataMin.apply(this._store,arguments),this},configure:function(t){return this._config=a.merge(this._config,t),this._renderer.updateConfig(this._config),this._coordinator.emit("renderall",this._store._getInternalData()),this},repaint:function(){return this._coordinator.emit("renderall",this._store._getInternalData()),this},getData:function(){return this._store.getData()},getDataURL:function(){return this._renderer.getDataURL()},getValueAt:function(t){return this._store.getValueAt?this._store.getValueAt(t):this._renderer.getValueAt?this._renderer.getValueAt(t):null}},e}(),r={create:function(t){return new s(t)},register:function(i,e){t.plugins[i]=e}};return r})},{}],2:[function(t,i,e){!function(){function e(t,i){this.setMap(t),this.map=t,this.cfg=i||{},qq.maps.Overlay.call(this)}function n(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}var a=t("./Heatmap.js"),s=window.QQMapPlugin=window.QQMapPlugin||{};e.prototype=new qq.maps.Overlay,e.CSS_TRANSFORM=function(){for(var t=document.createElement("div"),i=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],e=0;e<i.length;e++){var n=i[e];if(void 0!==t.style[n])return n}return i[0]}(),e.prototype.construct=function(){var t=this.container=document.createElement("div"),i=this.map,e=i.getContainer(),n=this.width=e.clientWidth,s=this.height=e.clientHeight;this.cfg.container=t,t.style.cssText="width:"+n+"px;height:"+s+"px;",this.data=[],this.max=1,this.min=0,this.getPanes().overlayLayer.appendChild(t);var r=this;this.changeHandler=qq.maps.event.addListener(i,"bounds_changed",function(){r.draw()}),this.heatmap||(this.heatmap=a.create(this.cfg)),this.constructed=!0},e.prototype.show=function(){this.container.style.display=""},e.prototype.hide=function(){this.container.style.display="none"},e.prototype.destroy=function(){this.container.parentElement.removeChild(this.container),this.changeHandler&&(qq.maps.event.removeListener(this.changeHandler),this.changeHandler=null)},e.prototype.draw=function(){if(this.map){var t=this.map.getBounds(),i=new qq.maps.LatLng(t.getNorthEast().getLat(),t.getSouthWest().getLng()),n=this.getProjection(),a=n.fromLatLngToDivPixel(i);this.container.style[e.CSS_TRANSFORM]="translate("+Math.round(a.x)+"px,"+Math.round(a.y)+"px)",this.update()}},e.prototype.resize=function(){if(this.map){var t=this.map.getContainer(),i=t.clientWidth,e=t.clientHeight;i==this.width&&e==this.height||(this.width=i,this.height=e,this.heatmap._renderer.setDimensions(i,e))}},e.prototype.update=function(){var t,i,e,n,a=this.map.getProjection();if(a&&(e=this.map.getBounds(),n=new qq.maps.LatLng(e.getNorthEast().getLat(),e.getSouthWest().getLng()),t=this.map.getZoom(),i=Math.pow(2,t),this.resize(),0!=this.data.length)){for(var s={max:this.max,min:this.min},r=[],o=this.data.length,h=this.getProjection(),l=h.fromLatLngToDivPixel(n),d=this.cfg.scaleRadius?i:20,u=0,c=0,p=this.cfg.valueField;o--;){var g=this.data[o],f=g[p],m=g.latlng;if(e.contains(m)){u=Math.max(f,u),c=Math.min(f,c);var x=h.fromLatLngToDivPixel(m),v={x:Math.round(x.x-l.x),y:Math.round(x.y-l.y)};v[p]=f;var y;y=g.radius?g.radius*d:(this.cfg.radius||2)*d,v.radius=y,r.push(v)}}this.cfg.useLocalExtrema&&(s.max=u,s.min=c),s.data=r,this.heatmap.setData(s)}},e.prototype.setData=function(t){var i=this;if(this.constructed){this.max=t.max,this.min=t.min;for(var e=this.cfg.latField||"lat",n=this.cfg.lngField||"lng",a=this.cfg.valueField||"value",t=t.data,s=t.length,r=[];s--;){var o=t[s],h=new qq.maps.LatLng(o[e],o[n]),l={latlng:h};l[a]=o[a],o.radius&&(l.radius=o.radius),r.push(l)}this.data=r,this.update()}else setTimeout(function(){i.setData(t)},100)},e.prototype.addData=function(t){if(t.length>0)for(var i=t.length;i--;)this.addData(t[i]);else{var e=this.cfg.latField||"lat",n=this.cfg.lngField||"lng",a=this.cfg.valueField||"value",s=t,r=new qq.maps.LatLng(s[e],s[n]),o={latlng:r};o[a]=s[a],s.radius&&(o.radius=s.radius),this.max=Math.max(this.max,o[a]),this.min=Math.min(this.min,o[a]),this.data.push(o),this.update()}},s.isSupportCanvas=n(),s.HeatmapOverlay=e,i.exports=e}()},{"./Heatmap.js":1}],3:[function(t,i,e){function n(t){return t&&t.context?(this.context=t.context,this.style=t.style||this.style,void this.init()):{}}n.prototype={constructor:n,style:{lineWidth:1,lineColor:"rgba(120, 180, 0, .8)"},init:function(){},setArc:function(t){this.arc=t},draw:function(){var t=this.context,i=this.arc;t.beginPath(),t.strokeStyle=this.style.lineColor,t.lineWidth=this.style.lineWidth,t.arc(i.x,i.y,i.radius,i.startAngle,i.endAngle,!1),t.stroke()}},i.exports=n},{}],4:[function(t,i,e){function n(t){return t&&t.context?(this.context=t.context,this.style=t.style||this.style,void this.init()):{}}var a=t("../core/Util.js");n.prototype={constructor:n,pathSpeed:1,arcLength:0,tailLength:80,tailPointsCount:30,pointRadius:2.5,style:{tailColor:"rgba(120, 180, 0, .8)"},init:function(){this.getTailPointColor=a.buildColorCreator(this.style.tailColor)},setArc:function(t){this.arc=t,this.pointAngle=this.pointAngle||this.arc.startAngle,this.angleSpeed=this.pathSpeed/this.arc.radius,this.arcLength=2*t.radius*Math.abs(t.endAngle-t.startAngle),this.arcLength<240&&(this.tailLength=this.arcLength/3),this.tailPointDeltaAngle=this.tailLength/this.arc.radius/this.tailPointsCount},draw:function(){var t=this.arc;this.pointAngle+=this.angleSpeed,this.pointAngle=Math.max(this.pointAngle,t.startAngle),this.pointAngle>t.endAngle&&(this.pointAngle=t.startAngle);for(var i=0,e=this.tailPointsCount;i<e;i++)this.drawArcPoint(t,this.getTailPointColor(.5-.5/e*i),this.pointAngle-this.tailPointDeltaAngle*i)},drawArcPoint:function(t,i,e){if(!(e<t.startAngle||e>t.endAngle)){var n=this.context;n.beginPath(),n.strokeStyle=i,n.lineWidth=2*this.pointRadius,n.lineCap="round",n.arc(t.x,t.y,t.radius,e-.001,e,!1),n.stroke()}},toString:function(){return[this.startX,this.startY,this.destX,this.destY].join(",")}},i.exports=n},{"../core/Util.js":11}],5:[function(t,i,e){function n(t){if(!s){var i=document.createElement("canvas"),e=i.getContext("2d"),n=2;i.width=2*n,i.height=2*n,e.fillStyle=t,e.lineWidth=0,e.beginPath(),e.arc(n,n,n,0,2*Math.PI,!1),e.closePath(),e.fill(),s=i}}function a(t){return t&&t.context?(this.context=t.context,this.style=t.style||this.style,void this.init()):{}}var s;t("../core/Util.js");a.prototype={constructor:a,pathSpeed:1,tailLength:80,tailPointsCount:30,radius:2,style:{highlightColor:"rgba(255, 255, 255, .9)"},init:function(){},setArc:function(t){this.arc=t,this.pointAngle=this.pointAngle||this.arc.startAngle,this.angleSpeed=this.pathSpeed/this.arc.radius},draw:function(){var t=this.arc;this.pointAngle+=this.angleSpeed,this.pointAngle=Math.max(this.pointAngle,t.startAngle),this.pointAngle>t.endAngle&&(this.pointAngle=t.startAngle),s||n(this.style.highlightColor),this.drawHeadPoint(t,this.pointAngle)},drawHeadPoint:function(t,i){if(!(i<t.startAngle||i>t.endAngle)){var e=t.x+t.radius*Math.sin(.5*Math.PI+i),n=t.y-t.radius*Math.cos(.5*Math.PI+i);this.context.drawImage(s,e-this.radius,n-this.radius)}}},i.exports=a},{"../core/Util.js":11}],6:[function(t,i,e){function n(t){return t&&t.context?(this.context=t.context,this.radius=t.radius||this.radius,void(this.style=t.style||this.style)):{}}var a,s=t("../core/Util.js"),r=function(t,i,e){function n(){requestAnimationFrame(function(){r(l),p>i-g?(m=!1,p=c):p+=e,o(i,i,p,t,f,g),m||o(i,i,i-g,t,f-2*f*p/i,g),n()})}function r(t){t.clearRect(0,0,t.canvas.width,t.canvas.height)}function o(t,i,e,n,a,s){l.beginPath(),l.strokeStyle=d(a),l.lineWidth=s,l.arc(t,i,e,0,2*Math.PI),l.closePath(),l.stroke()}if(!a){var h=document.createElement("canvas"),l=h.getContext("2d"),d=s.buildColorCreator(t),u=60;i=i||20,e=i/u,h.width=2*i,h.height=2*i;var c=1,p=c,g=2,f=.8;n();var m=!0;a=h}};n.prototype={postion:null,radius:20,speed:.5,style:{panColor:"rgba(120, 180, 0, .8)"},constructor:n,draw:function(){a||r(this.style.panColor,this.radius,this.speed),this.context.drawImage(a,this.postion.x,this.postion.y)},setPosition:function(t,i){this.postion={x:t-this.radius,y:i-this.radius}}},i.exports=n},{"../core/Util.js":11}],7:[function(t,i,e){function n(t){t&&(s.call(this,t),this.events={onPointClick:t.onPointClick,onLineClick:t.onLineClick},this.addListener())}var a=t("../core/Util.js"),s=t("../core/Animation.js"),r=t("../core/geo.js"),o=t("../core/TextLabel.js"),h=t("./Pulse.js"),l=t("./PulseHead.js"),d=t("./PulseRing.js"),u=t("./CircleArc.js");n.prototype=new s,n.prototype.construct=n,n.prototype.animated=!0,n.prototype.parseStyle=function(t){var i={lineWidth:1,lineColor:"rgba(120, 180, 0, .8)",highlightColor:"rgba(255, 255, 255, .8)",tailColor:"rgba(120, 180, 0, .8)",panColor:"rgba(120, 180, 0, .8)",textColor:"rgba(120, 180, 0, .8)",textSize:"12px",textFont:"微软雅黑",maxRadius:30,minRadius:3};if(t.maxRadius=t.radius,t)for(var e in t)e in i&&t[e]&&(e.toLocaleLowerCase().indexOf("color")>-1?i[e]=a.any2rgba(t[e]):i[e]=t[e]);return i},n.prototype.buildDataAndShapes=function(t){this.shapeGroups=this.prepareData(t),this.scene.setShapes(this.createShapes(this.shapeGroups)),this.viewChangeHandler(),this.scene.play()},n.prototype.prepareData=function(t){for(var i,e,n,s=t.points,r=t.links,c=this.context,p=this.style,g={context:c,style:p},f=this.style.radius||this.style.maxRadius,m=[],x={},v=0;n=r[v++];){var y=n.from.id,_=n.to.id,w=s[y],C=s[_];y in x||(x[y]={id:y,latlng:[w.lat,w.lng],text:n.from.name||y}),_ in x||(x[_]={id:_,latlng:[C.lat,C.lng],text:n.to.name||_})}for(var v in x){var b=x[v];b.latlng=new qq.maps.LatLng(b.latlng[0],b.latlng[1]),b.pan=new d(a.extend({radius:f},g)),b.label=new o(a.extend({text:b.text},g)),m.push(b)}for(var n,v=0;n=r[v++];)i=s[n.from.id],e=s[n.to.id],n.from.latlng=new qq.maps.LatLng(i.lat,i.lng),n.to.latlng=new qq.maps.LatLng(e.lat,e.lng),n.pulse=new h({context:c,style:p}),n.pulseHead=new l({context:c,style:p}),n.circleArc=new u({context:c,style:p});return{points:m,links:r}},n.prototype.createShapes=function(t){var i,e=t.points,n=t.links,a=[];for(var s in e)a.push(e[s].pan),a.push(e[s].label);for(var r=a.length,s=0,o=n.length;s<o;s++)i=n[s],a[r+s]=i.circleArc,a[r+s+o]=i.pulse,a[r+s+2*o]=i.pulseHead;return a},n.prototype.viewChangeHandler=function(){var t,i,e,n=this.shapeGroups.points,a=this.shapeGroups.links,s=this.style,o=this.getProjection();for(var h in n){var l=n[h],d=o.fromLatLngToContainerPixel(l.latlng);l.pan.setPosition(d.x,d.y),l.label.setPosition(d.x+(l.radius||10),d.y+parseInt(s.textSize)/2),l.bounds=r.getBounds(d,40)}for(var u,h=0;u=a[h++];)t=o.fromLatLngToContainerPixel(u.from.latlng),i=o.fromLatLngToContainerPixel(u.to.latlng),e=r.calculateArc(t.x,t.y,i.x,i.y),u.pulse.setArc(e),u.pulseHead.setArc(e),u.circleArc.setArc(e)},n.prototype.addListener=function(){var t=this.events.onPointClick,i=this.events.onLineClick;qq.maps.event.addListener(this.map,"click",function(e){var n=e.pixel;if("function"==typeof t)for(var a,a=this.shapeGroups.points,s=0;p=a[s++];)if(p.bounds&&r.inBounds(n,p.bounds))return void t({id:p.id,text:p.text,latlng:p.latlng});if("function"==typeof i)for(var o,h=10,l=this.shapeGroups.links,s=0;o=l[s++];)for(var d=o.circleArc.arc.segments,u=0,c=d.length;u<c-1;u++){var g=r.pointToLine(d[u],d[u+1],n);if(g<h)return void i({from:{id:o.from.id,latlng:o.from.latlng},to:{id:o.to.id,latlng:o.to.latlng}})}}.bind(this))},i.exports=n},{"../core/Animation.js":8,"../core/TextLabel.js":10,"../core/Util.js":11,"../core/geo.js":12,"./CircleArc.js":3,"./Pulse.js":4,"./PulseHead.js":5,"./PulseRing.js":6}],8:[function(t,i,e){function n(t){if(t=t||{},t.map){var i=t.map;this.fixFlag=!0,this.zoomChanging=!1,this.autoRender=!("autoRender"in t)||t.autoRender,this.transform=n.getTransformKey(),this.events={},this.setMap(i||null),this.setupStage(),this.style=this.parseStyle(t.style||this.style),t.data&&this.setData(t.data),this.mapStatus={zooming:!1,moving:!1,idle:!0}}}var a=t("./Scene.js"),s="c"+Math.random().toString(36).substr(2),r=document.createElement("style");r.innerHTML=[".",s,"{position:absolute}"].join(""),document.head.appendChild(r),n.prototype=new qq.maps.Overlay,n.prototype.construct=n,n.prototype.init=function(){},n.prototype.viewChangeHandler=function(){},n.prototype.buildDataAndShapes=function(t){},n.prototype.parseStyle=function(t){return t},n.prototype.setData=function(t){this.autoRender||this.resize(),this.mapLoaded?this.buildDataAndShapes(t):qq.maps.event.addListenerOnce(this.map,"idle",function(){this.buildDataAndShapes(t)}.bind(this))},n.prototype.setupStage=function(){this.mapDiv=this.map.getContainer(),this.scene=new a,qq.maps.event.addListenerOnce(this.map,"idle",function(){this.mapLoaded=!0,this.map&&(this.createDoms(),this.autoRender&&this.resize(),this.addMapStatusListeners(),this.autoRender&&(this.addFixListeners(),this.animated?this.addAnimatedListeners():this.addStaticListeners()),this.scene.setContext(this.context),this.init())}.bind(this))},n.prototype.createDoms=function(){var t=this.container=document.createElement("div"),i=this.canvas=document.createElement("canvas");this.context=i.getContext("2d"),this.container.appendChild(i),this.getPanes().overlayLayer.appendChild(t)},n.prototype.addMapStatusListeners=function(){var t=this.mapStatus;qq.maps.event.addListener(this.map,"zoom_changed",function(){t.zooming=!0}.bind(this)),qq.maps.event.addListener(this.map,"center_changed",function(){t.moving=!0}.bind(this)),qq.maps.event.addListener(this.map,"idle",function(){t.zooming=!1,t.moving=!1,t.idle=!0}.bind(this))},n.prototype.addFixListeners=function(){qq.maps.event.addListener(this.map,"idle",function(){this.resize.bind(this)()}.bind(this))},n.prototype.addAnimatedListeners=function(){var t=this.mapStatus;qq.maps.event.addListener(this.map,"idle",function(){this.viewChangeHandler.bind(this)(),this.scene.play()}.bind(this)),qq.maps.event.addListener(this.map,"bounds_changed",function(){t.zooming?(this.reposition(),this.viewChangeHandler.bind(this)()):this.scene.stop()}.bind(this))},n.prototype.addStaticListeners=function(){var t=this.mapStatus;qq.maps.event.addListener(this.map,"idle",function(){Date.now();this.viewChangeHandler.bind(this)();Date.now();this.scene.render()}.bind(this)),qq.maps.event.addListener(this.map,"bounds_changed",function(){if(t.zooming){this.reposition();Date.now();this.viewChangeHandler.bind(this)();Date.now();this.scene.render()}}.bind(this))},n.prototype.reposition=function(){var t=this.map.getBounds(),i=new qq.maps.LatLng(t.getNorthEast().getLat(),t.getSouthWest().getLng()),e=this.getProjection(),n=e.fromLatLngToDivPixel(i);this.container.style[this.transform]="translate("+Math.round(n.x)+"px,"+Math.round(n.y)+"px)"},n.prototype.resize=function(){var t=this.mapDiv.clientWidth,i=this.mapDiv.clientHeight;this.container.style.cssText="width:"+t+"px;height:"+i+"px;",this.canvas.width=t,this.canvas.height=i,this.reposition()},n.getTransformKey=function(){for(var t=document.createElement("div"),i=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],e=0;e<i.length;e++){var n=i[e];if(void 0!==t.style[n])return n}return i[0]},window.requestAnimationFrame||(window.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,i){window.setTimeout(t,1e3/60)}}()),i.exports=n},{"./Scene.js":9}],9:[function(t,i,e){function n(t){t=t||{},t.context&&this.setContext(t.context),this.playFlag=!1}n.prototype={constructor:n,setContext:function(t){this.context=t,this.updateSize()},render:function(){var t=this.shapes;this.clearCanvas();for(var i,e=(Date.now(),0);i=t[e++];)i.draw()},animate:function(){this.playFlag&&(this.render(),this.playFlag&&requestAnimationFrame(this.animate.bind(this)))},play:function(){this.playFlag||(this.playFlag=!0,this.animate())},stop:function(){this.playFlag=!1},clearCanvas:function(){var t=200;this.context.clearRect(-t,-t,this.width+t,this.height+t)},updateSize:function(){var t=this.context.canvas;this.width=t.width,this.height=t.height},add:function(t){this.shapes.push(t)},get:function(t){return this.shapes[t]},setShapes:function(t){this.shapes=t}},i.exports=n},{}],10:[function(t,i,e){function n(t){return t&&t.context?(this.context=t.context,this.text=t.text,this.style=t.style||this.style,void this.init()):{}}t("../core/Util.js");n.prototype={visible:!0,position:{x:0,y:0},style:{textColor:"rgba(120, 180, 0, 1)",font:"12px 微软雅黑"},constructor:n,init:function(){this.font=this.style.font||this.style.textSize+" "+this.style.textFont},draw:function(){if(this.visible){var t=this.position;this.write(t.x,t.y,this.style.textColor,this.font,this.text)}},write:function(t,i,e,n,a){var s=this.context;s.fillStyle=e,s.lineWidth=1,s.font=n,s.fillText(a,t,i)},setPosition:function(t,i){this.position={x:t,y:i}},show:function(){return this.visible=!0,this},hide:function(){return this.visible=!1,this}},i.exports=n},{"../core/Util.js":11}],11:[function(t,i,e){i.exports={extend:function(t,i,e){for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);if(e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},any2rgba:function(t,i){t=t.toLowerCase();var e=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;return i=i||1,t&&e.test(t)?this.hex2rgb(t):t.indexOf("rgba")?t:t.indexOf("rgb")>-1?this.rgb2rgba(t,i):void 0},hex2rgb:function(t,i){var t=t.toLowerCase();if(4===t.length){for(var e="#",n=1;n<4;n+=1)e+=t.slice(n,n+1).concat(t.slice(n,n+1));t=e}for(var a=[],n=1;n<7;n+=2)a.push(parseInt("0x"+t.slice(n,n+2)));return"rgba("+a.join(",")+","+(i||1)+")"},rgb2rgba:function(t,i){var e=t.replace("rgb(","rgba(").replace(")","").split(/\,|\)/);return 3==e.length&&e.push(i||"0.8"),e.join(",")+")"},buildColorCreator:function(t){var i=this.rgb2rgba(t).replace("rgb(","rgba(").split(",").splice(0,3).join(",")+",";return function(t){return i+t+")"}}}},{}],12:[function(t,i,e){i.exports={ll2mc:function(t){var i=111319.49077777778*t.lng,e=Math.log(Math.tan(.008726646259971648*(90+t.lat)))/.017453292519943295*111319.49077777778;return{x:i,y:e}},mc2ll:function(t){var i=t.x/111319.49077777778,e=Math.atan(Math.exp(t.y/111319.49077777778*.017453292519943295))/.008726646259971648-90;return{lat:e,lng:i}},distance:function(t,i){return Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2))},pointToLine:function(t,i,e){var n,a,s,r=0;if(n=this.distance(t,i),a=this.distance(t,e),s=this.distance(i,e),s+a==n)return r=0;if(n<=1e-5)return r=a;if(s*s>=n*n+a*a)return r=a;if(a*a>=n*n+s*s)return r=s;var o=(n+a+s)/2,h=Math.sqrt(o*(o-n)*(o-a)*(o-s));return r=2*h/n},calculateArc:function(t,i,e,n){var a,s,r=Math.sqrt(Math.pow(t-e,2)+Math.pow(i-n,2)),o=(t+e)/2,h=(i+n)/2,l=1.8;a=(i-n)*l+o,s=(e-t)*l+h;var d=Math.sqrt(Math.pow(r/2,2)+Math.pow(r*l,2)),u=Math.atan2(i-s,t-a),c=Math.atan2(n-s,e-a);u>c&&(c+=2*Math.PI);var p=function(){function r(t,i,e,n){return{x:t+e*Math.sin(.5*Math.PI+n),y:i-e*Math.cos(.5*Math.PI+n)}}for(var o=Math.max(~~(Math.sqrt(d)/6),3),h=(c-u)/o,l=[{x:t,y:i}],p=1;p<o;p++)l.push(r(a,s,d,u+p*h));return l.push({x:e,y:n}),l}(),g={x:a,y:s,radius:d,startAngle:u,endAngle:c,l:r,segments:p};return g},getBounds:function(t,i){return{topLeft:{x:t.x-i/2,y:t.y-i/2},bottomRight:{x:t.x+i/2,y:t.y+i/2}}},inBounds:function(t,i){return t.x>i.topLeft.x&&t.x<i.bottomRight.x&&t.y>i.topLeft.y&&t.y<i.bottomRight.y},latlngInBounds:function(t,i){return t.lat<=i.max.lat&&t.lat>=i.min.lat&&t.lng<=i.max.lng&&t.lng>=i.min.lng},boundsInBounds:function(t,i){return t.max.lat<=i.max.lat&&t.max.lng<=i.max.lng&&t.min.lat>=i.min.lat&&t.min.lng>=i.min.lng},getUnionBounds:function(t,i){return this.boundsCrossBounds(t,i)?{max:{lat:Math.min(t.max.lat,i.max.lat),lng:Math.min(t.max.lng,i.max.lng)},min:{lat:Math.max(t.min.lat,i.min.lat),lng:Math.max(t.min.lng,i.min.lng)}}:null},boundsCrossBounds:function(t,i){return!(t.min.lat>i.max.lat||t.max.lat<i.min.lat||t.min.lng>i.max.lng||t.max.lng<i.min.lng)}}},{}],13:[function(t,i,e){var n=qq.maps.plugin=qq.maps.plugin||{};n.Radiation=t("./Radiation"),n.Heat=t("./Heat")},{"./Heat":2,"./Radiation":7}]},{},[13]);